SELECT
	PFFINANC.CODCOLIGADA,
    CONVERT(VARCHAR(2), MAX(MESCOMP)) + '/' + CONVERT(VARCHAR(4), MAX(ANOCOMP)) AS COMPETENCIA,
    PFFINANC.CODEVENTO,
    PEVENTO.DESCRICAO,
    SUM(PFFINANC.VALOR) AS VALOR

FROM PFFINANC
    JOIN PEVENTO ON PEVENTO.CODCOLIGADA = PFFINANC.CODCOLIGADA AND PEVENTO.CODIGO = PFFINANC.CODEVENTO

WHERE 1=1
    AND PFFINANC.CODCOLIGADA = 5
    AND PFFINANC.ANOCOMP = 2025
    AND PFFINANC.MESCOMP = 10

GROUP BY
    PFFINANC.CODCOLIGADA,
    PFFINANC.ANOCOMP,
    PFFINANC.MESCOMP,
    PFFINANC.CODEVENTO,
    PEVENTO.DESCRICAO

ORDER BY
    PFFINANC.CODCOLIGADA,
    PFFINANC.ANOCOMP DESC,
    PFFINANC.MESCOMP DESC,
    PFFINANC.CODEVENTO,
    PEVENTO.DESCRICAO

/*
SELECT 
    MAX(PFPERFF.CODCOLIGADA) AS COLIGADA,
    CONVERT(VARCHAR(2), MAX(PFPERFF.MESCOMP)) + '/' + CONVERT(VARCHAR(4), MAX(PFPERFF.ANOCOMP)) AS COMPETENCIA,
    SUM(PFPERFF.BASEFGTS) AS BASEFGTS,
    SUM(PFPERFF.BASEFGTS13) AS BASEFGTS13,
    SUM(PFPERFF.BASEINSS) AS BASEINSS,
    SUM(PFPERFF.BASEINSS13) AS BASEINSS13

FROM PFPERFF 
    
WHERE 1=1
    AND PFPERFF.CODCOLIGADA = 5
    AND PFPERFF.MESCOMP = 10
    AND PFPERFF.ANOCOMP = 2025

SELECT
    PFPERFF.CODCOLIGADA,
    CONVERT(VARCHAR(2), PFPERFF.MESCOMP) + '/' + CONVERT(VARCHAR(4), PFPERFF.ANOCOMP) AS COMPETENCIA,
    PFPERFF.BASEFGTS,
    PFPERFF.BASEFGTS13,
    PFPERFF.BASEINSS,
    PFPERFF.BASEINSS13,
    PFUNC.CODSITUACAO,
    PFUNC.DATADEMISSAO

FROM PFPERFF 
    JOIN PFUNC ON  PFUNC.CODCOLIGADA=PFPERFF.CODCOLIGADA AND PFUNC.CHAPA=PFPERFF.CHAPA
    
WHERE 1=1
    AND PFPERFF.CODCOLIGADA = 5
    AND PFPERFF.MESCOMP = 10
    AND PFPERFF.ANOCOMP = 2025
    AND PFPERFF.BASEINSS <= 1271.5
    AND PFPERFF.BASEINSS > 0
    AND PFPERFF.BASEINSS13 <= 0

ORDER BY 5 DESC
*/